# `Kaduda-AI`

Welcome to your new `offline_ai` project and to the Internet Computer development community. By default, creating a new project adds this README and some template files to your project directory. You can edit these template files to customize your project and to include your own code to speed up the development cycle.

To get started, you might want to explore the project directory structure and the default configuration file. Working with this project in your development environment will not affect any production deployment or identity tokens.

To learn more before you start working with `offline_ai`, see the following documentation available online:

- [Quick Start](https://internetcomputer.org/docs/current/developer-docs/setup/deploy-locally)
- [SDK Developer Tools](https://internetcomputer.org/docs/current/developer-docs/setup/install)
- [Motoko Programming Language Guide](https://internetcomputer.org/docs/current/motoko/main/motoko)
- [Motoko Language Quick Reference](https://internetcomputer.org/docs/current/motoko/main/language-manual)

If you want to start working on your project right away, you might want to try the following commands:

```bash
cd offline_ai/
dfx help
dfx canister --help
```

## Running the project locally

To run and test your `offline_ai` project locally on the Internet Computer, you can use the following steps:

### **Step 1: Start the ICP Local Replica**
Start the Internet Computer (ICP) replica locally to simulate the mainnet environment:

```bash
dfx start --background
```

This command will start the local replica of the Internet Computer in the background.

### **Step 2: Deploy Your Canisters**
Once the local replica is running, you can deploy your canisters to it. Canisters are the computational units in ICP (similar to smart contracts on other blockchains).

```bash
dfx deploy
```

This command will deploy your backend canister(s) to the local replica. It also generates a Candid interface, which defines the public interface of your canister.

Once the deployment is complete, you can access your application at the following address:
```
http://localhost:4943?canisterId={asset_canister_id}
```

### **Step 3: Generate New Candid Interface**
If you make changes to your backend canister, itâ€™s recommended to generate a new Candid interface before proceeding with the frontend development:

```bash
npm run generate
```

This command regenerates the Candid file and ensures that your frontend correctly communicates with the backend. This step is particularly important after making updates to your canister logic.

### **Step 4: Start the Frontend Development Server**
To start making changes to the frontend, you can launch a development server that will serve the frontend locally and proxy API requests to the backend.

```bash
npm start
```

This command will start a frontend development server at `http://localhost:8080`. The frontend will proxy API calls to the ICP local replica at port `4943`.

## Deploying the Application

Once you've tested your application locally, you're ready to deploy it to production on the Internet Computer mainnet.

### **Step 1: Deploy to Mainnet**
To deploy your project to the Internet Computer mainnet, ensure you set the `DFX_NETWORK` environment variable to `ic` (the mainnet):

```bash
dfx deploy --network ic
```

This command will deploy your canister to the ICP mainnet, and the application will be publicly accessible.

### **Step 2: Access the Application on Mainnet**
Once the deployment is complete, your application will be available at a URL generated by the mainnet deployment. For example:
```
https://{your_canister_id}.ic0.app
```

Make sure to replace `{your_canister_id}` with your actual canister ID from the deployment output.

### **Handling Environment Variables**
In a production environment, you may need to handle environment variables to configure your frontend and backend components correctly. Here are some strategies to ensure your project is production-ready:

- **For Webpack Users:**
  Set `DFX_NETWORK` to `ic` in your environment configuration file to ensure that your project does not fetch the root key in production:

  ```bash
  export DFX_NETWORK=ic
  ```

- **Custom Handling:**
  Use your preferred method to override `process.env.DFX_NETWORK` in your autogenerated declarations. One approach is to configure `dfx.json`:

  ```json
  {
    "canisters": {
      "{asset_canister_id}": {
        "declarations": {
          "env_override": "ic"
        }
      }
    }
  }
  ```

- **Custom `createActor` Function:**
  If necessary, you can write your own `createActor` function to handle how the frontend communicates with the backend canister.

## Notes on Twilio and OpenAI Integration

This project integrates **Twilio** for SMS handling and **OpenAI** for AI-generated responses. Below are instructions on how to run this functionality:

### Running `app.js` Locally

Make sure the environment variables for Twilio, OpenAI, and ICP canister are set correctly in a `.env` file in the root directory:

```
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=your_twilio_phone_number
OPENAI_API_KEY=your_openai_api_key
CANISTER_ID=your_icp_canister_id
PORT=3000
```

Install the required dependencies:

```bash
npm install express body-parser openai twilio @dfinity/agent
```

Run the app locally:

```bash
node app.js
```

The Express server will run on the port specified in the `.env` file (default is 3000).

### Deploying the Node.js App

You can deploy the `app.js` file using cloud platforms like **Heroku**, **Vercel**, or **AWS Lambda** for serverless deployment. Instructions for deploying to Heroku and Vercel are provided in the previous sections.
